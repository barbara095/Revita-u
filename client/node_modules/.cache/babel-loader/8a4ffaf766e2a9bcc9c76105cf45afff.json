{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport React, { memo, useEffect, useRef } from 'react';\nimport PropTypes from 'prop-types';\nimport { Pane } from '../../layers';\nimport MenuItem from './MenuItem';\nimport MenuDivider from './MenuDivider';\nimport MenuGroup from './MenuGroup';\nimport MenuOption from './MenuOption';\nimport MenuOptionsGroup from './MenuOptionsGroup';\nvar Menu = memo(function Menu(props) {\n  var menuRef = useRef(null);\n  var firstItem = useRef();\n  var lastItem = useRef();\n  var menuItems = useRef();\n  useEffect(function () {\n    var currentMenuRef = menuRef.current;\n    menuItems.current = currentMenuRef ? _toConsumableArray(currentMenuRef.querySelectorAll('[role=\"menuitemradio\"]:not([disabled]), [role=\"menuitem\"]:not([disabled])')) : [];\n\n    if (menuItems.current.length === 0) {\n      throw new Error('The menu has no menu items');\n    }\n\n    firstItem.current = menuItems.current[0];\n    lastItem.current = menuItems.current[menuItems.current.length - 1]; // Go to next/previous item if it exists\n    // or loop around\n\n    var focusNext = function focusNext(currentItem, startItem) {\n      // Determine which item is the startItem (first or last)\n      var goingDown = startItem === firstItem.current; // Helper function for getting next legitimate element\n\n      var move = function move(elem) {\n        var indexOfItem = menuItems.current.indexOf(elem);\n\n        if (goingDown) {\n          if (indexOfItem < menuItems.current.length - 1) {\n            return menuItems.current[indexOfItem + 1];\n          }\n\n          return startItem;\n        }\n\n        if (indexOfItem - 1 > -1) {\n          return menuItems.current[indexOfItem - 1];\n        }\n\n        return startItem;\n      }; // Make first move\n\n\n      var nextItem = move(currentItem); // Focus the first one that's not disabled\n\n      nextItem.focus();\n    };\n\n    function onKeyPressListener(e) {\n      var target = e.target;\n      var menuItem = menuItems.current && menuItems.current.find(function (item) {\n        return item === target;\n      });\n\n      if (!menuItem) {\n        return;\n      }\n\n      if (e.key === 'ArrowDown') {\n        e.preventDefault();\n        focusNext(menuItem, firstItem.current);\n      }\n\n      if (e.key === 'ArrowUp') {\n        e.preventDefault();\n        focusNext(menuItem, lastItem.current);\n      }\n\n      if (e.key === 'Home') {\n        e.preventDefault();\n        firstItem.current.focus();\n      }\n\n      if (e.key === 'End') {\n        e.preventDefault();\n        lastItem.current.focus();\n      }\n    }\n\n    currentMenuRef.addEventListener('keydown', onKeyPressListener);\n    return function () {\n      currentMenuRef.removeEventListener('keydown', onKeyPressListener);\n    };\n  }, [menuRef]);\n  var children = props.children;\n  return React.createElement(Pane, {\n    is: \"nav\",\n    ref: menuRef,\n    role: \"menu\",\n    outline: \"none\"\n  }, children);\n});\nMenu.Item = MenuItem;\nMenu.Divider = MenuDivider;\nMenu.Group = MenuGroup;\nMenu.Divider = MenuDivider;\nMenu.Group = MenuGroup;\nMenu.Option = MenuOption;\nMenu.OptionsGroup = MenuOptionsGroup;\nMenu.propTypes = {\n  /**\n   * The children of the component.\n   */\n  children: PropTypes.node\n};\nexport default Menu;","map":{"version":3,"sources":["../../../src/menu/src/Menu.js"],"names":["Menu","memo","menuRef","useRef","firstItem","lastItem","menuItems","useEffect","currentMenuRef","focusNext","goingDown","startItem","move","indexOfItem","nextItem","target","e","menuItem","item","children","props","PropTypes","node"],"mappings":"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","sourcesContent":["import React, { memo, useEffect, useRef } from 'react'\nimport PropTypes from 'prop-types'\nimport { Pane } from '../../layers'\nimport MenuItem from './MenuItem'\nimport MenuDivider from './MenuDivider'\nimport MenuGroup from './MenuGroup'\nimport MenuOption from './MenuOption'\nimport MenuOptionsGroup from './MenuOptionsGroup'\n\nconst Menu = memo(function Menu(props) {\n\n  const menuRef = useRef(null)\n  const firstItem = useRef()\n  const lastItem = useRef()\n\n  const menuItems = useRef()\n\n  useEffect(() => {\n\n    const currentMenuRef = menuRef.current\n\n    menuItems.current = currentMenuRef ? [\n      ...currentMenuRef.querySelectorAll(\n        '[role=\"menuitemradio\"]:not([disabled]), [role=\"menuitem\"]:not([disabled])'\n     )]\n    : []\n\n    if (menuItems.current.length === 0) {\n      throw new Error('The menu has no menu items')\n    }\n\n    firstItem.current = menuItems.current[0]\n    lastItem.current = menuItems.current[menuItems.current.length - 1]\n\n    // Go to next/previous item if it exists\n    // or loop around\n    const focusNext = (currentItem, startItem) => {\n\n      // Determine which item is the startItem (first or last)\n      const goingDown = startItem === firstItem.current\n\n      // Helper function for getting next legitimate element\n      const move = elem => {\n        const indexOfItem = menuItems.current.indexOf(elem)\n\n        if (goingDown) {\n          if (indexOfItem < menuItems.current.length - 1) {\n            return menuItems.current[indexOfItem + 1]\n          }\n\n          return startItem\n        }\n\n        if (indexOfItem - 1 > -1) {\n          return menuItems.current[indexOfItem - 1]\n        }\n\n        return startItem\n      }\n\n      // Make first move\n      const nextItem = move(currentItem)\n\n      // Focus the first one that's not disabled\n      nextItem.focus()\n    }\n\n    function onKeyPressListener(e) {\n\n      const { target } = e\n      const menuItem = menuItems.current && menuItems.current.find((item) => item === target)\n\n      if(!menuItem) {\n        return\n      }\n\n      if (e.key === 'ArrowDown') {\n        e.preventDefault()\n        focusNext(menuItem, firstItem.current)\n      }\n\n      if (e.key === 'ArrowUp') {\n        e.preventDefault()\n        focusNext(menuItem, lastItem.current)\n      }\n\n      if (e.key === 'Home') {\n        e.preventDefault()\n        firstItem.current.focus()\n      }\n\n      if (e.key === 'End') {\n        e.preventDefault()\n        lastItem.current.focus()\n      }\n    }\n\n    currentMenuRef.addEventListener('keydown', onKeyPressListener)\n\n    return () => {\n      currentMenuRef.removeEventListener('keydown', onKeyPressListener)\n    }\n  }, [menuRef])\n\n  const { children } = props\n  return (\n    <Pane is=\"nav\" ref={menuRef} role=\"menu\" outline=\"none\">\n      {children}\n    </Pane>\n  )\n})\n\nMenu.Item = MenuItem\nMenu.Divider = MenuDivider\nMenu.Group = MenuGroup\nMenu.Divider = MenuDivider\nMenu.Group = MenuGroup\nMenu.Option = MenuOption\nMenu.OptionsGroup = MenuOptionsGroup\n\nMenu.propTypes = {\n  /**\n   * The children of the component.\n   */\n  children: PropTypes.node\n}\n\nexport default Menu\n"]},"metadata":{},"sourceType":"module"}