{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport React, { memo, forwardRef, useState, useRef, useCallback } from 'react';\nimport PropTypes from 'prop-types';\nimport Box from 'ui-box';\nimport cx from 'classnames';\nimport { Button } from '../../buttons';\nimport { TextInput } from '../../text-input';\nimport safeInvoke from '../../lib/safe-invoke';\nexport var CLASS_PREFIX = 'evergreen-file-picker';\nvar FilePicker = memo(forwardRef(function FilePicker(props, ref) {\n  var name = props.name,\n      accept = props.accept,\n      required = props.required,\n      multiple = props.multiple,\n      onBlur = props.onBlur,\n      disabled = props.disabled,\n      capture = props.capture,\n      height = props.height,\n      onChange = props.onChange,\n      _props$placeholder = props.placeholder,\n      placeholder = _props$placeholder === void 0 ? 'Select a file to uploadâ€¦' : _props$placeholder,\n      className = props.className,\n      rest = _objectWithoutProperties(props, [\"name\", \"accept\", \"required\", \"multiple\", \"onBlur\", \"disabled\", \"capture\", \"height\", \"onChange\", \"placeholder\", \"className\"]);\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      files = _useState2[0],\n      setFiles = _useState2[1];\n\n  var fileInputRef = useRef();\n  var handleFileChange = useCallback(function (e) {\n    // Firefox returns the same array instance each time for some reason\n    var filesCopy = _toConsumableArray(e.target.files);\n\n    setFiles(filesCopy);\n    safeInvoke(onChange, filesCopy);\n  }, [onChange]);\n  var handleButtonClick = useCallback(function () {\n    if (fileInputRef && fileInputRef.current) {\n      fileInputRef.current.click();\n    }\n  }, [fileInputRef]);\n  var handleBlur = useCallback(function (e) {\n    // Setting e.target.files to an array fails. It must be a FileList\n    if (e && e.target) e.target.files = fileInputRef && fileInputRef.current && fileInputRef.current.files;\n    safeInvoke(onBlur, e);\n  }, [onBlur]);\n  var inputValue;\n\n  if (files.length === 0) {\n    inputValue = '';\n  } else if (files.length === 1) {\n    inputValue = files[0].name;\n  } else {\n    inputValue = \"\".concat(files.length, \" files\");\n  }\n\n  var buttonText;\n\n  if (files.length === 0) {\n    buttonText = 'Select file';\n  } else if (files.length === 1) {\n    buttonText = 'Replace file';\n  } else {\n    buttonText = 'Replace files';\n  }\n\n  var rootClassNames = cx(\"\".concat(CLASS_PREFIX, \"-root\"), className);\n  return React.createElement(Box, _extends({\n    display: \"flex\",\n    className: rootClassNames,\n    ref: ref\n  }, rest), React.createElement(Box, {\n    ref: fileInputRef,\n    className: \"\".concat(CLASS_PREFIX, \"-file-input\"),\n    is: \"input\",\n    type: \"file\",\n    name: name,\n    accept: accept,\n    required: required,\n    multiple: multiple,\n    disabled: disabled,\n    capture: capture,\n    onChange: handleFileChange,\n    display: \"none\"\n  }), React.createElement(TextInput, {\n    className: \"\".concat(CLASS_PREFIX, \"-text-input\"),\n    readOnly: true,\n    value: inputValue,\n    placeholder: placeholder // There's a weird specifity issue when there's two differently sized inputs on the page\n    ,\n    borderTopRightRadius: \"0 !important\",\n    borderBottomRightRadius: \"0 !important\",\n    height: height,\n    flex: 1,\n    textOverflow: \"ellipsis\",\n    onBlur: handleBlur\n  }), React.createElement(Button, {\n    className: \"\".concat(CLASS_PREFIX, \"-button\"),\n    onClick: handleButtonClick,\n    disabled: disabled,\n    borderTopLeftRadius: 0,\n    borderBottomLeftRadius: 0,\n    height: height,\n    flexShrink: 0,\n    type: \"button\",\n    onBlur: handleBlur\n  }, buttonText));\n}));\nFilePicker.propTypes = {\n  /**\n   * Name attribute of the input.\n   */\n  name: PropTypes.string,\n\n  /**\n   * The accept attribute of the input.\n   */\n  accept: PropTypes.oneOfType([PropTypes.string, PropTypes.arrayOf(PropTypes.string)]),\n\n  /**\n   * When true, the file picker is required.\n   */\n  required: PropTypes.bool,\n\n  /**\n   * When true, accept multiple files.\n   */\n  multiple: PropTypes.bool,\n\n  /**\n   * When true, the filepicker is disabled.\n   */\n  disabled: PropTypes.bool,\n\n  /**\n   * The capture attribute of the input.\n   */\n  capture: PropTypes.bool,\n\n  /**\n   * The height of the file picker.\n   */\n  height: PropTypes.number,\n\n  /**\n   * Function called when onChange is fired.\n   * (files: FileList) => void\n   */\n  onChange: PropTypes.func,\n\n  /**\n   * Function called when onBlur is fired.\n   * (event: React.FocusEvent) => void\n   */\n  onBlur: PropTypes.func,\n\n  /**\n   * Placeholder of the text input\n   */\n  placeholder: PropTypes.string,\n\n  /**\n   * Class name passed to the FilePicker.\n   * Only use this if you know what you are doing.\n   */\n  className: PropTypes.string\n};\nexport default FilePicker;","map":{"version":3,"sources":["../../../src/file-picker/src/FilePicker.js"],"names":["CLASS_PREFIX","FilePicker","memo","forwardRef","name","accept","required","multiple","onBlur","disabled","capture","height","onChange","placeholder","className","rest","props","files","setFiles","useState","fileInputRef","useRef","handleFileChange","useCallback","filesCopy","e","safeInvoke","handleButtonClick","handleBlur","inputValue","buttonText","rootClassNames","cx","ref","PropTypes","string"],"mappings":"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","sourcesContent":["import React, { memo, forwardRef, useState, useRef, useCallback } from 'react'\nimport PropTypes from 'prop-types'\nimport Box from 'ui-box'\nimport cx from 'classnames'\nimport { Button } from '../../buttons'\nimport { TextInput } from '../../text-input'\nimport safeInvoke from '../../lib/safe-invoke'\n\nexport const CLASS_PREFIX = 'evergreen-file-picker'\n\nconst FilePicker = memo(\n  forwardRef(function FilePicker(props, ref) {\n    const {\n      name,\n      accept,\n      required,\n      multiple,\n      onBlur,\n      disabled,\n      capture,\n      height,\n      onChange,\n      placeholder = 'Select a file to uploadâ€¦',\n      className,\n      ...rest\n    } = props\n\n    const [files, setFiles] = useState([])\n    const fileInputRef = useRef()\n\n    const handleFileChange = useCallback(\n      e => {\n        // Firefox returns the same array instance each time for some reason\n        const filesCopy = [...e.target.files]\n\n        setFiles(filesCopy)\n\n        safeInvoke(onChange, filesCopy)\n      },\n      [onChange]\n    )\n\n    const handleButtonClick = useCallback(() => {\n      if (fileInputRef && fileInputRef.current) {\n        fileInputRef.current.click()\n      }\n    }, [fileInputRef])\n\n    const handleBlur = useCallback(\n      e => {\n        // Setting e.target.files to an array fails. It must be a FileList\n        if (e && e.target)\n          e.target.files =\n            fileInputRef && fileInputRef.current && fileInputRef.current.files\n\n        safeInvoke(onBlur, e)\n      },\n      [onBlur]\n    )\n\n    let inputValue\n    if (files.length === 0) {\n      inputValue = ''\n    } else if (files.length === 1) {\n      inputValue = files[0].name\n    } else {\n      inputValue = `${files.length} files`\n    }\n\n    let buttonText\n    if (files.length === 0) {\n      buttonText = 'Select file'\n    } else if (files.length === 1) {\n      buttonText = 'Replace file'\n    } else {\n      buttonText = 'Replace files'\n    }\n\n    const rootClassNames = cx(`${CLASS_PREFIX}-root`, className)\n\n    return (\n      <Box\n        display=\"flex\"\n        className={rootClassNames}\n        ref={ref}\n        {...rest}\n      >\n        <Box\n          ref={fileInputRef}\n          className={`${CLASS_PREFIX}-file-input`}\n          is=\"input\"\n          type=\"file\"\n          name={name}\n          accept={accept}\n          required={required}\n          multiple={multiple}\n          disabled={disabled}\n          capture={capture}\n          onChange={handleFileChange}\n          display=\"none\"\n        />\n\n        <TextInput\n          className={`${CLASS_PREFIX}-text-input`}\n          readOnly\n          value={inputValue}\n          placeholder={placeholder}\n          // There's a weird specifity issue when there's two differently sized inputs on the page\n          borderTopRightRadius=\"0 !important\"\n          borderBottomRightRadius=\"0 !important\"\n          height={height}\n          flex={1}\n          textOverflow=\"ellipsis\"\n          onBlur={handleBlur}\n        />\n\n        <Button\n          className={`${CLASS_PREFIX}-button`}\n          onClick={handleButtonClick}\n          disabled={disabled}\n          borderTopLeftRadius={0}\n          borderBottomLeftRadius={0}\n          height={height}\n          flexShrink={0}\n          type=\"button\"\n          onBlur={handleBlur}\n        >\n          {buttonText}\n        </Button>\n      </Box>\n    )\n  })\n)\n\nFilePicker.propTypes = {\n  /**\n   * Name attribute of the input.\n   */\n  name: PropTypes.string,\n\n  /**\n   * The accept attribute of the input.\n   */\n  accept: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.arrayOf(PropTypes.string)\n  ]),\n\n  /**\n   * When true, the file picker is required.\n   */\n  required: PropTypes.bool,\n\n  /**\n   * When true, accept multiple files.\n   */\n  multiple: PropTypes.bool,\n\n  /**\n   * When true, the filepicker is disabled.\n   */\n  disabled: PropTypes.bool,\n\n  /**\n   * The capture attribute of the input.\n   */\n  capture: PropTypes.bool,\n\n  /**\n   * The height of the file picker.\n   */\n  height: PropTypes.number,\n\n  /**\n   * Function called when onChange is fired.\n   * (files: FileList) => void\n   */\n  onChange: PropTypes.func,\n\n  /**\n   * Function called when onBlur is fired.\n   * (event: React.FocusEvent) => void\n   */\n  onBlur: PropTypes.func,\n\n  /**\n   * Placeholder of the text input\n   */\n  placeholder: PropTypes.string,\n\n  /**\n   * Class name passed to the FilePicker.\n   * Only use this if you know what you are doing.\n   */\n  className: PropTypes.string\n}\n\nexport default FilePicker\n"]},"metadata":{},"sourceType":"module"}