{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nimport React, { memo, useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport debounce from 'lodash.debounce';\nimport { SelectMenu } from '../../select-menu';\nimport { CaretDownIcon } from '../../icons';\nimport TextTableCell from './TextTableCell';\nimport TableCell from './TableCell';\nvar MIN_SELECT_MENU_WIDTH = 240;\nvar emptyProps = {};\nvar SelectMenuCell = memo(function SelectMenuCell(props) {\n  var _useState = useState(MIN_SELECT_MENU_WIDTH),\n      _useState2 = _slicedToArray(_useState, 2),\n      targetWidth = _useState2[0],\n      setTargetWidth = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      shouldClickToggle = _useState4[0],\n      setShouldClickToggle = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      isFocused = _useState6[0],\n      setIsFocused = _useState6[1];\n\n  var _useState7 = useState(),\n      _useState8 = _slicedToArray(_useState7, 2),\n      mainRef = _useState8[0],\n      setMainRef = _useState8[1];\n\n  var children = props.children,\n      _props$size = props.size,\n      size = _props$size === void 0 ? 300 : _props$size,\n      selectMenuProps = props.selectMenuProps,\n      disabled = props.disabled,\n      placeholder = props.placeholder,\n      _props$isSelectable = props.isSelectable,\n      isSelectable = _props$isSelectable === void 0 ? true : _props$isSelectable,\n      _props$textProps = props.textProps,\n      textProps = _props$textProps === void 0 ? emptyProps : _props$textProps,\n      rest = _objectWithoutProperties(props, [\"children\", \"size\", \"selectMenuProps\", \"disabled\", \"placeholder\", \"isSelectable\", \"textProps\"]);\n\n  var updateOnResize = function updateOnResize() {\n    if (!mainRef) return;\n    var mainRefWidth = mainRef.offsetWidth;\n    setTargetWidth(Math.max(MIN_SELECT_MENU_WIDTH, mainRefWidth));\n  };\n\n  var onResize = debounce(updateOnResize, 200);\n  useEffect(function () {\n    updateOnResize();\n    window.addEventListener('resize', onResize, false);\n    return function () {\n      window.removeEventListener('resize', onResize);\n    };\n  }, []);\n\n  var onMainRef = function onMainRef(getRef, ref) {\n    setMainRef(ref);\n    getRef(ref);\n  };\n\n  var handleKeyDown = function handleKeyDown(toggle, isShown, e) {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      e.stopPropagation();\n\n      if (!isShown && isSelectable && !disabled) {\n        toggle();\n      }\n    }\n  };\n\n  var handleDoubleClick = function handleDoubleClick(toggle, isShown) {\n    if (!isShown && isSelectable && !disabled) {\n      toggle();\n    }\n  };\n\n  var handleClick = function handleClick(toggle, isShown) {\n    if (!shouldClickToggle && !isShown) {\n      setShouldClickToggle(true);\n      return;\n    }\n\n    if (isSelectable && !disabled) {\n      toggle();\n      setShouldClickToggle(true);\n    }\n  };\n\n  var handleFocus = function handleFocus() {\n    setIsFocused(true);\n  };\n\n  var handleBlur = function handleBlur() {\n    setShouldClickToggle(false);\n    setIsFocused(false);\n  };\n\n  var cursor = 'default';\n\n  if (disabled) {\n    cursor = 'not-allowed';\n  } else if (isSelectable) {\n    if (isFocused) {\n      cursor = 'pointer';\n    } else {\n      cursor = 'default';\n    }\n  } else {\n    cursor = 'text';\n  }\n\n  return React.createElement(SelectMenu, _extends({\n    width: targetWidth\n  }, selectMenuProps), function (_ref) {\n    var toggle = _ref.toggle,\n        getRef = _ref.getRef,\n        isShown = _ref.isShown;\n    return React.createElement(TextTableCell, _extends({\n      ref: onMainRef.bind(null, getRef),\n      onClick: handleClick.bind(null, toggle, isShown),\n      onFocus: handleFocus.bind(null, toggle, isShown),\n      onBlur: handleBlur,\n      isSelectable: isSelectable && !disabled,\n      rightView: isSelectable ? React.createElement(CaretDownIcon, {\n        color: \"muted\"\n      }) : null,\n      \"aria-haspopup\": true,\n      \"aria-expanded\": isShown,\n      cursor: isShown ? 'pointer' : cursor,\n      textProps: _objectSpread({\n        size: size,\n        opacity: disabled || !children && placeholder ? 0.5 : 1\n      }, textProps),\n      onKeyDown: handleKeyDown.bind(null, toggle, isShown),\n      onDoubleClick: handleDoubleClick.bind(null, toggle, isShown)\n    }, rest), children ? children : placeholder);\n  });\n});\nSelectMenuCell.propTypes = _objectSpread(_objectSpread({}, TableCell.propTypes), {}, {\n  /*\n   * Makes the TableCell focusable.\n   * Will add tabIndex={-1 || this.props.tabIndex}.\n   */\n  isSelectable: PropTypes.bool,\n\n  /**\n   * When true, the cell can't be edited.\n   */\n  disabled: PropTypes.bool,\n\n  /**\n   * Optional placeholder when children is falsy.\n   */\n  placeholder: PropTypes.node,\n\n  /**\n   * The size used for the TextTableCell and Textarea.\n   */\n  size: PropTypes.oneOf([300, 400]),\n  selectMenuProps: PropTypes.object\n});\nexport default SelectMenuCell;","map":{"version":3,"sources":["../../../src/table/src/SelectMenuCell.js"],"names":["MIN_SELECT_MENU_WIDTH","emptyProps","SelectMenuCell","memo","targetWidth","setTargetWidth","useState","shouldClickToggle","setShouldClickToggle","isFocused","setIsFocused","mainRef","setMainRef","children","size","selectMenuProps","disabled","placeholder","isSelectable","textProps","rest","props","updateOnResize","mainRefWidth","Math","onResize","debounce","useEffect","window","onMainRef","getRef","handleKeyDown","e","toggle","handleDoubleClick","handleClick","handleFocus","handleBlur","cursor","isShown","opacity","TableCell","PropTypes","object"],"mappings":"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","sourcesContent":["import React, { memo, useState, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport debounce from 'lodash.debounce'\nimport { SelectMenu } from '../../select-menu'\nimport { CaretDownIcon } from '../../icons'\nimport TextTableCell from './TextTableCell'\nimport TableCell from './TableCell'\n\nconst MIN_SELECT_MENU_WIDTH = 240\nconst emptyProps = {}\n\nconst SelectMenuCell = memo(function SelectMenuCell(props) {\n  const [targetWidth, setTargetWidth] = useState(MIN_SELECT_MENU_WIDTH)\n  const [shouldClickToggle, setShouldClickToggle] = useState(false)\n  const [isFocused, setIsFocused] = useState(false)\n  const [mainRef, setMainRef] = useState()\n\n  const {\n    children,\n    size = 300,\n    selectMenuProps,\n    disabled,\n    placeholder,\n    isSelectable = true,\n    textProps = emptyProps,\n    ...rest\n  } = props\n\n  const updateOnResize = () => {\n    if (!mainRef) return\n    const mainRefWidth = mainRef.offsetWidth\n    setTargetWidth(Math.max(MIN_SELECT_MENU_WIDTH, mainRefWidth))\n  }\n\n  const onResize = debounce(updateOnResize, 200)\n\n  useEffect(() => {\n    updateOnResize()\n    window.addEventListener('resize', onResize, false)\n\n    return () => {\n      window.removeEventListener('resize', onResize)\n    }\n  }, [])\n\n  const onMainRef = (getRef, ref) => {\n    setMainRef(ref)\n    getRef(ref)\n  }\n\n  const handleKeyDown = (toggle, isShown, e) => {\n    if (e.key === 'Enter') {\n      e.preventDefault()\n      e.stopPropagation()\n\n      if (!isShown && isSelectable && !disabled) {\n        toggle()\n      }\n    }\n  }\n\n  const handleDoubleClick = (toggle, isShown) => {\n    if (!isShown && isSelectable && !disabled) {\n      toggle()\n    }\n  }\n\n  const handleClick = (toggle, isShown) => {\n    if (!shouldClickToggle && !isShown) {\n      setShouldClickToggle(true)\n      return\n    }\n\n    if (isSelectable && !disabled) {\n      toggle()\n      setShouldClickToggle(true)\n    }\n  }\n\n  const handleFocus = () => {\n    setIsFocused(true)\n  }\n\n  const handleBlur = () => {\n    setShouldClickToggle(false)\n    setIsFocused(false)\n  }\n\n  let cursor = 'default'\n  if (disabled) {\n    cursor = 'not-allowed'\n  } else if (isSelectable) {\n    if (isFocused) {\n      cursor = 'pointer'\n    } else {\n      cursor = 'default'\n    }\n  } else {\n    cursor = 'text'\n  }\n\n  return (\n    <SelectMenu width={targetWidth} {...selectMenuProps}>\n      {({ toggle, getRef, isShown }) => {\n        return (\n          <TextTableCell\n            ref={onMainRef.bind(null, getRef)}\n            onClick={handleClick.bind(null, toggle, isShown)}\n            onFocus={handleFocus.bind(null, toggle, isShown)}\n            onBlur={handleBlur}\n            isSelectable={isSelectable && !disabled}\n            rightView={isSelectable ? <CaretDownIcon color=\"muted\" /> : null}\n            aria-haspopup\n            aria-expanded={isShown}\n            cursor={isShown ? 'pointer' : cursor}\n            textProps={{\n              size,\n              opacity: disabled || (!children && placeholder) ? 0.5 : 1,\n              ...textProps\n            }}\n            onKeyDown={handleKeyDown.bind(null, toggle, isShown)}\n            onDoubleClick={handleDoubleClick.bind(null, toggle, isShown)}\n            {...rest}\n          >\n            {children ? children : placeholder}\n          </TextTableCell>\n        )\n      }}\n    </SelectMenu>\n  )\n})\n\nSelectMenuCell.propTypes = {\n  /**\n   * Composes the TableCell component as the base.\n   */\n  ...TableCell.propTypes,\n\n  /*\n   * Makes the TableCell focusable.\n   * Will add tabIndex={-1 || this.props.tabIndex}.\n   */\n  isSelectable: PropTypes.bool,\n\n  /**\n   * When true, the cell can't be edited.\n   */\n  disabled: PropTypes.bool,\n\n  /**\n   * Optional placeholder when children is falsy.\n   */\n  placeholder: PropTypes.node,\n\n  /**\n   * The size used for the TextTableCell and Textarea.\n   */\n  size: PropTypes.oneOf([300, 400]),\n\n  selectMenuProps: PropTypes.object\n}\n\nexport default SelectMenuCell\n"]},"metadata":{},"sourceType":"module"}